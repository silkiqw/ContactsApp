import Contacts

enum ContactField: String {
    case birthday
    case emailAddresses
    case familyName
    case givenName
    case jobTitle
    case middleName
    case namePrefix
    case nameSuffix
    case organizationName
    case phoneNumbers
    case postalAddresses
    case urlAddresses
    case note
    case photo

    var descriptor: CNKeyDescriptor {
        switch self {
        case .birthday:
            return CNContactBirthdayKey as CNKeyDescriptor
        case .emailAddresses:
            return CNContactEmailAddressesKey as CNKeyDescriptor
        case .familyName:
            return CNContactFamilyNameKey as CNKeyDescriptor
        case .givenName:
            return CNContactGivenNameKey as CNKeyDescriptor
        case .jobTitle:
            return CNContactJobTitleKey as CNKeyDescriptor
        case .middleName:
            return CNContactMiddleNameKey as CNKeyDescriptor
        case .namePrefix:
            return CNContactNamePrefixKey as CNKeyDescriptor
        case .nameSuffix:
            return CNContactNameSuffixKey as CNKeyDescriptor
        case .organizationName:
            return CNContactOrganizationNameKey as CNKeyDescriptor
        case .phoneNumbers:
            return CNContactPhoneNumbersKey as CNKeyDescriptor
        case .postalAddresses:
            return CNContactPostalAddressesKey as CNKeyDescriptor
        case .urlAddresses:
            return CNContactUrlAddressesKey as CNKeyDescriptor
        case .note:
            return CNContactNoteKey as CNKeyDescriptor
        case .photo:
            return CNContactImageDataKey as CNKeyDescriptor
        }
    }

    func copy(from source: CNContact, to target: CNMutableContact) {
        let key = descriptor.description
        guard source.isKeyAvailable(key) else { return }

        switch self {
        case .birthday:
            target.birthday = source.birthday
        case .emailAddresses:
            target.emailAddresses = source.emailAddresses
        case .familyName:
            target.familyName = source.familyName
        case .givenName:
            target.givenName = source.givenName
        case .jobTitle:
            target.jobTitle = source.jobTitle
        case .middleName:
            target.middleName = source.middleName
        case .namePrefix:
            target.namePrefix = source.namePrefix
        case .nameSuffix:
            target.nameSuffix = source.nameSuffix
        case .organizationName:
            target.organizationName = source.organizationName
        case .phoneNumbers:
            target.phoneNumbers = source.phoneNumbers
        case .postalAddresses:
            target.postalAddresses = source.postalAddresses
        case .urlAddresses:
            target.urlAddresses = source.urlAddresses
        case .note:
            target.note = source.note
        case .photo:
            target.imageData = source.imageData
        }
    }

}
